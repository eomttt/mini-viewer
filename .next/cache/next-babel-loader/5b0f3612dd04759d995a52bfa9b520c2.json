{"ast":null,"code":"var _jsxFileName = \"/Users/hyuntaeeom/Projects/personal/mini-viewer/pages/index.tsx\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport styled from 'styled-components';\nconst Container = styled.div.withConfig({\n  displayName: \"pages__Container\",\n  componentId: \"sc-18mi7mi-0\"\n})([\"\"]);\n\nconst Home = bookInfo => {\n  console.log('RRR', bookInfo);\n  const {\n    readItems,\n    book,\n    basePath\n  } = bookInfo;\n  const {\n    items,\n    images,\n    styles,\n    ncx\n  } = book;\n  const imagesId = images.map(image => image.id);\n  const stylesId = styles.map(style => style.id); // useEffect(() => {\n  //   const {\n  //     items, images, styles, ncx,\n  //   } = book;\n  //   const imagesId = images.map((image) => image.id);\n  //   const stylesId = styles.map((style) => style.id);\n  //   const viewer = {\n  //     styles: [],\n  //     items: [],\n  //     ncx: []\n  //   };\n  //   items.map((item, index) => {\n  //     if (imagesId.includes(item.id)) {\n  //       viewer.items.push({\n  //         type: 'image',\n  //         id: item.id,\n  //         soruce: `${basePath}/${item.href}`,\n  //       });\n  //     }\n  //     if (stylesId.includes(item.id)) {\n  //       viewer.styles.push(`${basePath}/${item.href}`);\n  //     }\n  //     if (ncx.id === item.id) {\n  //       return <div>NCX</div>;\n  //     }\n  //     // eslint-disable-next-line react/no-danger\n  //     return <div dangerouslySetInnerHTML={{ __html: readItems[index] }} />;\n  //   });\n  // }, [book, basePath, readItems]);\n\n  const renderBookItem = (bookItem, readItem) => {\n    if (imagesId.includes(bookItem.id)) {\n      return __jsx(\"img\", {\n        src: `${basePath}/${bookItem.href}`,\n        alt: \"Cover\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50\n        },\n        __self: this\n      });\n    }\n\n    if (stylesId.includes(bookItem.id)) {\n      return __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: `${basePath}/${bookItem.href}`,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      });\n    } // if (ncx.id === bookItem.id) {\n    //   return <div>NCX</div>;\n    // }\n    // eslint-disable-next-line react/no-danger\n\n\n    return __jsx(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: readItem\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    });\n  };\n\n  const renderItems = () => items.map((item, idx) => {\n    return __jsx(\"section\", {\n      key: idx,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, renderBookItem(item, readItems[idx]));\n  });\n\n  return __jsx(Container, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, renderItems());\n};\n\nHome.getInitialProps = async context => {\n  const {\n    req\n  } = context;\n\n  if (req) {\n    const {\n      EpubParser\n    } = require('@ridi/epub-parser');\n\n    try {\n      const parser = new EpubParser('public/pg61625-images.epub');\n      const book = await parser.parse({\n        validatePackage: true,\n        parseStyle: false,\n        unzipPath: 'public/epub/pg61625-images'\n      });\n      const readSpines = await parser.readItems(book.spines);\n      const readItems = await parser.readItems(book.items, {\n        force: true,\n        extractBody: true,\n        serializedAnchor: true,\n        ignoreScript: true,\n        basePath: 'epub/pg61625-images'\n      });\n      return {\n        book,\n        readSpines,\n        readItems,\n        basePath: 'epub/pg61625-images'\n      };\n    } catch (error) {\n      console.log('Error', error);\n    }\n  }\n\n  return {};\n};\n\nexport default Home;","map":{"version":3,"sources":["/Users/hyuntaeeom/Projects/personal/mini-viewer/pages/index.tsx"],"names":["React","styled","Container","div","Home","bookInfo","console","log","readItems","book","basePath","items","images","styles","ncx","imagesId","map","image","id","stylesId","style","renderBookItem","bookItem","readItem","includes","href","__html","renderItems","item","idx","getInitialProps","context","req","EpubParser","require","parser","parse","validatePackage","parseStyle","unzipPath","readSpines","spines","force","extractBody","serializedAnchor","ignoreScript","error"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { NextPageContext } from 'next';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n`;\n\nconst Home = (bookInfo) => {\n  console.log('RRR', bookInfo);\n  const { readItems, book, basePath } = bookInfo;\n  const {\n    items, images, styles, ncx,\n  } = book;\n  const imagesId = images.map((image) => image.id);\n  const stylesId = styles.map((style) => style.id);\n  // useEffect(() => {\n  //   const {\n  //     items, images, styles, ncx,\n  //   } = book;\n  //   const imagesId = images.map((image) => image.id);\n  //   const stylesId = styles.map((style) => style.id);\n\n  //   const viewer = {\n  //     styles: [],\n  //     items: [],\n  //     ncx: []\n  //   };\n\n  //   items.map((item, index) => {\n  //     if (imagesId.includes(item.id)) {\n  //       viewer.items.push({\n  //         type: 'image',\n  //         id: item.id,\n  //         soruce: `${basePath}/${item.href}`,\n  //       });\n  //     }\n  //     if (stylesId.includes(item.id)) {\n  //       viewer.styles.push(`${basePath}/${item.href}`);\n  //     }\n  //     if (ncx.id === item.id) {\n  //       return <div>NCX</div>;\n  //     }\n  //     // eslint-disable-next-line react/no-danger\n  //     return <div dangerouslySetInnerHTML={{ __html: readItems[index] }} />;\n  //   });\n  // }, [book, basePath, readItems]);\n\n  const renderBookItem = (bookItem, readItem): JSX.Element => {\n    if (imagesId.includes(bookItem.id)) {\n      return <img src={`${basePath}/${bookItem.href}`} alt=\"Cover\" />;\n    }\n    if (stylesId.includes(bookItem.id)) {\n      return <link rel=\"stylesheet\" href={`${basePath}/${bookItem.href}`} />;\n    }\n    // if (ncx.id === bookItem.id) {\n    //   return <div>NCX</div>;\n    // }\n    // eslint-disable-next-line react/no-danger\n    return <div dangerouslySetInnerHTML={{ __html: readItem }} />;\n  };\n\n  const renderItems = (): JSX.Element => items.map((item, idx) => {\n    return (\n      <section key={idx}>\n        {renderBookItem(item, readItems[idx])}\n      </section>\n    );\n  });\n\n  return (\n    <Container>\n      {renderItems()}\n    </Container>\n  );\n};\n\nHome.getInitialProps = async (context: NextPageContext): Promise<any> => {\n  const { req } = context;\n  if (req) {\n    const { EpubParser } = require('@ridi/epub-parser');\n    try {\n      const parser = new EpubParser('public/pg61625-images.epub');\n      const book = await parser.parse({\n        validatePackage: true,\n        parseStyle: false,\n        unzipPath: 'public/epub/pg61625-images',\n      });\n      const readSpines = await parser.readItems(book.spines);\n      const readItems = await parser.readItems(book.items, {\n        force: true,\n        extractBody: true,\n        serializedAnchor: true,\n        ignoreScript: true,\n        basePath: 'epub/pg61625-images',\n      });\n\n      return {\n        book,\n        readSpines,\n        readItems,\n        basePath: 'epub/pg61625-images',\n      };\n    } catch (error) {\n      console.log('Error', error);\n    }\n  }\n\n\n  return {};\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}